{"version":3,"sources":["webpack:///src/app/folder/perfil-update/perfil-update.page.html","webpack:///src/app/folder/perfil-update/perfil-update-routing.module.ts","webpack:///src/app/folder/perfil-update/perfil-update.module.ts","webpack:///src/app/folder/perfil-update/perfil-update.page.scss","webpack:///src/app/folder/perfil-update/perfil-update.page.ts"],"names":["routes","path","component","PerfilUpdatePageRoutingModule","imports","forChild","exports","PerfilUpdatePageModule","declarations","PerfilUpdatePage","usuarioService","angularFireStorage","loadingController","router","alertCtrt","mensajeErrorService","user","getUsuario","localStorage","getItem","subscribe","res","image","FotoPerfil","mensaje","create","cssClass","message","loading","present","event","target","files","file","reader","FileReader","onload","e","result","readAsDataURL","form","presentLoading","telefono","value","length","slice","UpdateUserCompleto","storageRef","storage","ref","child","name","put","then","data","getDownloadURL","downloadURL","err","dismiss","failedAlert","text","header","buttons","handler","alert","Telefono","userId","updateUsuario","auth","navigateByUrl","error","code","split","presentarMensaje","AuthErrorCodeSpanish","selector","template"],"mappings":"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","file":"folder-perfil-update-perfil-update-module-es5.js","sourcesContent":["export default \"<ion-header >\\r\\n  <ion-toolbar>\\r\\n\\r\\n    <ion-segment color=\\\"tertiary\\\" value=\\\"perfil\\\" >\\r\\n\\r\\n      <!-- <ion-segment-button *ngIf=\\\"Rol==Ayudante\\\" value=\\\"mis-ayudantias\\\" [routerLink]=\\\"['/mis-ayudantias']\\\" routerDirection=\\\"root\\\">\\r\\n        <ion-icon name=\\\"file-tray-stacked-outline\\\" size=\\\"large\\\"></ion-icon> \\r\\n        <ion-label style=\\\"font-size: 14;\\\">Mis Cursos</ion-label>\\r\\n      </ion-segment-button> -->\\r\\n\\r\\n      <ion-segment-button value=\\\"publicaciones\\\" [routerLink]=\\\"['/publicaciones']\\\" routerDirection=\\\"root\\\">\\r\\n        <ion-icon name=\\\"newspaper-outline\\\" size=\\\"large\\\"></ion-icon> \\r\\n        <ion-label style=\\\"font-size: 14;\\\">Publicaciones</ion-label>\\r\\n      </ion-segment-button>\\r\\n      \\r\\n      <ion-segment-button value=\\\"cursos\\\" [routerLink]=\\\"['/cursos']\\\" routerDirection=\\\"root\\\">\\r\\n        <ion-icon name=\\\"library-outline\\\" size=\\\"large\\\"></ion-icon> <ion-label style=\\\"font-size: 14px;\\\">Cursos</ion-label>\\r\\n      </ion-segment-button>\\r\\n    \\r\\n    \\r\\n      <ion-segment-button value=\\\"perfil\\\" [routerLink]=\\\"['/perfil']\\\" routerDirection=\\\"root\\\">\\r\\n        <ion-icon name=\\\"person-circle-outline\\\" size=\\\"large\\\"></ion-icon> <ion-label style=\\\"font-size: 12px;\\\">Perfil</ion-label>\\r\\n      </ion-segment-button>\\r\\n\\r\\n      <ion-segment-button value=\\\"adopcion\\\" [routerLink]=\\\"['/adopcion']\\\" routerDirection=\\\"root\\\">\\r\\n        <ion-icon name=\\\"paw-outline\\\" size=\\\"large\\\"></ion-icon> <ion-label style=\\\"font-size: 12px;\\\">Adopcion</ion-label>\\r\\n      </ion-segment-button>\\r\\n\\r\\n      <!-- <ion-segment-button value=\\\"citas\\\" *ngIf = \\\"user.Citas\\\" [routerLink]=\\\"['/perfil']\\\" routerDirection=\\\"root\\\">\\r\\n        <ion-icon name=\\\"flame-outline\\\" size=\\\"large\\\"></ion-icon> <ion-label style=\\\"font-size: 12px;\\\">Citas</ion-label>\\r\\n      </ion-segment-button> -->\\r\\n\\r\\n  \\r\\n\\r\\n  \\r\\n\\r\\n    </ion-segment>\\r\\n\\r\\n  </ion-toolbar>\\r\\n\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n\\r\\n  <form #form=\\\"ngForm\\\" (ngSubmit)=\\\"UpdateUser(form)\\\">\\r\\n    <ion-list>   \\r\\n        \\r\\n  \\r\\n\\r\\n \\r\\n      \\r\\n\\r\\n\\r\\n\\r\\n      <ion-item>\\r\\n        <ion-label><ion-icon name=\\\"logo-whatsapp\\\"></ion-icon> <ion-text color=\\\"danger\\\"></ion-text></ion-label>\\r\\n        <ion-input value=\\\"{{user.Telefono}}\\\" name=\\\"telefono\\\" required type='text' ngModel></ion-input>\\r\\n      </ion-item>\\r\\n\\r\\n      \\r\\n      \\r\\n      <ion-item>\\r\\n\\r\\n                  <ion-img id=\\\"blah\\\" [src]=\\\"image\\\" alt=\\\"your image\\\" style=\\\"margin-top:7.5px;margin-bottom: 7.5px;height: 350px;width: 350px;\\\"></ion-img>\\r\\n         \\r\\n        </ion-item>\\r\\n\\r\\n\\r\\n      <!-- <ion-item>\\r\\n        <ion-label><ion-icon name=\\\"image-outline\\\"></ion-icon><ion-text style='margin-left: 7.5px;'>Cambiar foto</ion-text></ion-label>\\r\\n      </ion-item>\\r\\n      <ion-item>\\r\\n        <ion-input type='file' accept=\\\"image/*\\\" id=\\\"perfilFoto\\\" name=\\\"foto\\\" (change)=\\\"readURL($event);\\\" class=\\\"fileInput\\\" ngModel></ion-input>\\r\\n      </ion-item> -->\\r\\n\\r\\n      <ion-item>\\r\\n        <ion-label><ion-icon name=\\\"cloud-upload-outline\\\"></ion-icon>  <ion-text style='margin-left:7.5px'>Cambiar foto</ion-text></ion-label>\\r\\n        <ion-input id=\\\"myFileInput\\\" (change)=\\\"readURL($event);\\\" accept=\\\"image/*\\\" placeholder=\\\"archivo\\\" name=\\\"archivo\\\" type='file' ngModel value=\\\"{{file}}\\\"></ion-input>\\r\\n      \\r\\n     \\r\\n      </ion-item>\\r\\n\\r\\n\\r\\n      \\r\\n\\r\\n\\r\\n    </ion-list> \\r\\n\\r\\n    <div class=\\\"ion-padding\\\" align=\\\"center\\\">\\r\\n      <ion-button type=\\\"submit\\\"  [disabled]=\\\"form.invalid\\\" expand=\\\"block\\\" style=\\\"width: 150px;\\\">\\r\\n        Actualizar\\r\\n      </ion-button>\\r\\n      \\r\\n    </div>\\r\\n  </form>\\r\\n\\r\\n</ion-content>\\r\\n<style>\\r\\n  #myFileInput{\\r\\n    position: absolute;\\r\\n    opacity: 0;\\r\\n  }\\r\\n</style>\";","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { PerfilUpdatePage } from './perfil-update.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: PerfilUpdatePage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class PerfilUpdatePageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { PerfilUpdatePageRoutingModule } from './perfil-update-routing.module';\r\n\r\nimport { PerfilUpdatePage } from './perfil-update.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    PerfilUpdatePageRoutingModule\r\n  ],\r\n  declarations: [PerfilUpdatePage]\r\n})\r\nexport class PerfilUpdatePageModule {}\r\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2ZvbGRlci9wZXJmaWwtdXBkYXRlL3BlcmZpbC11cGRhdGUucGFnZS5zY3NzIn0= */\";","import { Component, OnInit } from '@angular/core';\r\nimport { Usuarios } from 'src/app/models/usuarios';\r\nimport { UsuarioService } from 'src/app/services/usuario.service';\r\nimport { AngularFireStorage } from 'angularfire2/storage';\r\nimport { Router } from '@angular/router';\r\nimport { AlertController, LoadingController } from '@ionic/angular';\r\nimport { MensajeErrorService } from 'src/app/services/mensaje-error.service';\r\n\r\n\r\n@Component({\r\n  selector: 'app-perfil-update',\r\n  templateUrl: './perfil-update.page.html',\r\n  styleUrls: ['./perfil-update.page.scss'],\r\n})\r\nexport class PerfilUpdatePage implements OnInit {\r\n\r\n  public user: Usuarios=new Usuarios();\r\n  public image;\r\n  file: File;\r\n  loading: HTMLIonLoadingElement;\r\n\r\n  constructor(private usuarioService: UsuarioService,\r\n              private angularFireStorage: AngularFireStorage,\r\n              public loadingController: LoadingController,\r\n              private router: Router,\r\n              private alertCtrt: AlertController,\r\n              private mensajeErrorService: MensajeErrorService,\r\n              ) { }\r\n\r\n  ngOnInit() {\r\n\r\n\r\n    this.usuarioService.getUsuario(localStorage.getItem('userId')).subscribe(res => {this.user =res; this.image=res.FotoPerfil;});\r\n\r\n  }\r\n\r\n  async presentLoading(mensaje: string) {\r\n    this.loading = await this.loadingController.create({\r\n      cssClass: 'my-custom-class',\r\n      message: mensaje,\r\n      //duration: 2000\r\n    });\r\n    return this.loading.present();\r\n  }\r\n\r\n\r\n  readURL(event): void {\r\n    if (event.target.files && event.target.files[0]) {\r\n        this.file = event.target.files[0];\r\n\r\n        const reader = new FileReader();\r\n        reader.onload = e => this.image = reader.result;\r\n\r\n        reader.readAsDataURL(this.file);\r\n    }\r\n  }\r\n\r\n\r\n  async UpdateUser(form):Promise<void>{\r\n   // this.presentLoading(\"Espere por favor...\");\r\n   this.presentLoading(\"Espere por favor...\");\r\n    var telefono = form.value.telefono;\r\n    if(telefono.length==10){\r\n      telefono = '+593' + telefono.slice(1,telefono.length);\r\n    }\r\n\r\n    \r\n    // if(this.file!='null'){\r\n    //   this.guardarArchivo(telefono);\r\n    // }\r\n    // else{\r\n      this.UpdateUserCompleto(telefono,this.image)\r\n    // }\r\n    \r\n  }\r\n\r\n  guardarArchivo(telefono: string){\r\n    //this.presentLoading(\"Espere por favor...\");\r\n    \r\n    var storageRef = this.angularFireStorage.storage.ref()\r\n\r\n    \r\n    storageRef.child(this.file.name).put(this.file)\r\n    .then(\r\n            data=>{\r\n                    data.ref.getDownloadURL().then(\r\n                        downloadURL => {\r\n                          this.UpdateUserCompleto(telefono, downloadURL)\r\n\r\n                      \r\n                        }\r\n                    ).catch(err=>{this.loading.dismiss(), this.failedAlert(\"Error al cargar la foto de perfil, intentelo de nuevo\")});\r\n                    \r\n\r\n            }\r\n    )     \r\n\r\n\r\n  }\r\n\r\n  async failedAlert(text: string) {\r\n    const alert = await this.alertCtrt.create({\r\n     cssClass: 'my-custom-class',\r\n     header: text,\r\n    buttons: [{\r\n    text: 'OK',\r\n      handler: () => {\r\n        \r\n      }\r\n    }]   \r\n    });\r\n    await alert.present();\r\n  }\r\n\r\n \r\n\r\n  \r\n  async UpdateUserCompleto(telefono: string, downloadURL:string){\r\n    this.user.Telefono = telefono;\r\n    this.user.FotoPerfil = downloadURL;\r\n    var userId = localStorage.getItem('userId')\r\n    this.usuarioService.updateUsuario(userId, this.user).\r\n    then(\r\n      auth=>{\r\n        this.loading.dismiss();\r\n        \r\n        this.router.navigateByUrl(\"/perfil\")\r\n       \r\n       \r\n      }  \r\n    ).catch(async error => {\r\n      this.loading.dismiss();\r\n      var mensaje=error.code.split('/')[1];\r\n      const presentarMensaje = this.mensajeErrorService.AuthErrorCodeSpanish(mensaje);\r\n      this.failedAlert(presentarMensaje)\r\n    })\r\n  }\r\n\r\n\r\n\r\n}\r\n"]}